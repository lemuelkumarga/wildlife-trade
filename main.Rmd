---
title: "Identifying Major Players in Endangered Wildlife Trade"
author: '<span class="meta">Lemuel Kumarga</span>'
date: '<span class="meta">May 2018</span>'
always_allow_html: yes
knit: (function(inputFile, encoding) { source("shared/knit.R"); knitter(inputFile, encoding) })
---

```{r echo=FALSE, warning=FALSE, results='hide'}
packages <- c("knitr")
tmp <- lapply(packages, library, character.only = TRUE)

# Set images globally
opts_chunk$set(fig.align='center', fig.height = 4, fig.width = 7)
read_chunk("main.R")
  
```

## Problem Description

Since the Stone Age, mankind has turned to nature for food, commerce and companionship. Our impact back then was minimal as resources were consumed at sustainable rates. However, over the past few decades, nature is increasingly under threat from overconsumption and excess capitalism. Our planet is facing multiple challenges on the environmental front, ranging from global warming to forest degradation. 

One corrosive impact of our greed is the shrinking wildlife diversity and population. In 2000, IUCN counted a total of around <a href="https://portals.iucn.org/library/sites/library/files/documents/RL-2000-001.pdf" target="_blank">10,000 endangered species</a>. By 2017, this number has doubled to <a href="https://www.statista.com/statistics/269910/red-list-endangered-animals-2010-and-2000/" target="_blank">24,431 species</a>. In the face of such overwhelming statistics, it is imperative for us to take action and protect these species from extinction. In this project, we will aim to contribute by using data from both <a href="https://www.cites.org/eng/disc/what.php" target="_blank">CITES (Convention on Internation Trade in Endangered Species of Wild Fauna and Flora)</a> and <a href="http://www.iucnredlist.org/about/introduction" target="_blank">IUCN</a> <span class="hl">to identify the major players behind endangered wildlife trade</span>.

To skip the methodology and proceed straight to the results, please click <a href="#summary-of-results">here</a>.

## Preliminaries

First load the necessary packages for this exercise.
```{r}
<<init>>

si <- sessionInfo()
base_pkg_str <- paste0("Base Packages: ",paste(si[["basePkgs"]], collapse=", "))
attached_pkg_str <- paste0("Attached Packages: ",paste(names(si[["otherPkgs"]]), collapse=", "))
cat(paste0(base_pkg_str,"\n",attached_pkg_str))
```

## About the Data

We will be using wildlife trade data from <a href="https://www.cites.org/" target="_blank">CITES</a> for the period of 2001 to 2015, with the following caveats:

* 2016 and 2017 were excluded due to data lag in the year of analysis (2018). (See <a href="https://trade.cites.org/cites_trade_guidelines/en-CITES_Trade_Database_Guide.pdf" target="_blank">Section 1.2.2 of the guide</a> for more details).
* Analysis will be restricted to trades whose sources originated from the wild.

Listed below is an overview of the CITES data:
```{r}
<<data-overview>>
  
pander(cols_summary, caption='Wildlife Trade Data - For more info, please visit <a href="https://trade.cites.org/" target="_blank">CITES Trade Database</a>')
```

From the <a href="https://trade.cites.org/cites_trade_guidelines/en-CITES_Trade_Database_Guide.pdf" target="_blank">guide</a> and the above summary, we know that:

1. Each row corresponds to the <span class="hl">total trade</span> between two countries for a particular species at a particular unit. This is contrary to popular belief that each row corresponds to one shipment. (See Section 3.1 for more details)
2. Not all animals in the data are endangered. For example, the <a href="https://en.wikipedia.org/wiki/White-tailed_eagle" target="_blank">white-tailed eagle (Haliaeetus albicilla)</a> is specified as <span class="hl">Least Concern</span> on <a href="http://www.iucnredlist.org/details/22695137/0" target="_blank">IUCN Red List</a>.
3. Terms are <span class="hl">heterogenous</span>. For examples, some trade quantities correspond to bodies, while others correspond to feathers.
4. Units are also <span class="hl">varied</span>. Quantities can be quoted as distinct counts (i.e. blank Unit), or in terms of weight/volume/qualitative units.

As can be seen, some pre-processing would be required before our analysis can proceed. In particular, (3) and (4) need to be standardized to allow comparison across species.

## Pre-Processing

### Rescoping the Species

#### Animals Only

In the data, taxonomies with blank <span class="hl">Class</span> correspond to plants. For the purposes of this analysis, we will exclude non-animals from the dataset.

```{r}
<<pp-restrict-animals>>

cat(sprintf("%i rows removed (%.0f%% of total)",pre_clean - post_clean,(pre_clean - post_clean)/pre_clean * 100))
```

#### Endangered Only

Endangered status of species are located in <a href="http://www.iucnredlist.org/" target="_blank">IUCN Red List database</a>. Due to licensing restrictions, the data could not be uploaded for public use. However, one is free to create an account and download the csv from <a href="http://www.iucnredlist.org/search/saved?id=90695" target="_blank">here</a>.

Listed below is an example of the IUCN's data:

```{r}
<<pp-iucn-data>>

pander(head(iucn_dataset %>% select(Class, Order, Family, Genus, Species, Common.names..Eng.,Red.List.status),3))
```

Using the data above, we can subsequently filter non-endangered species out of the CITES dataset.
```{r}
<<pp-restrict-endanger>>
  
cat(sprintf("%i rows removed (%.0f%% of total)",pre_clean - post_clean,(pre_clean - post_clean)/pre_clean * 100))
```

### Standardizing the Terms

## Exploration

## Tracing Supply and Demand

### The Algorithm

### Following the Demand

### Finding the Supply

## Summary of Results

## Limitations

* Wild
* Unidentified Species

## References

